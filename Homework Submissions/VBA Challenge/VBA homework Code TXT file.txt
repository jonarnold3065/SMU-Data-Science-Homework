VBA homework Code TXT file 

Sub StockAnalysis():

    Dim ws As Worksheet
    

  ' Set an initial variable for holding the brand name
    Dim stock_ticker As String
    Dim i As Double
    Dim percent_change As Double
    
    Dim last_row As Long
    
  
  ' Set an initial variable for holding the total per stock
  Dim volume_total As Double
  
  
   '  details for YTD changes
    Dim final_close As Double
    Dim first_open As Double
    Dim yearly_change As Double
    Dim ytd_change As Double
    
    ' details for greatest changes
    
    Dim greatest_total_volume As Double
    
    'second summary table stuff
    Dim max_increase_ticker As String
    Dim max_increase As Double
    Dim min_increase_ticker As String
    Dim min_increase As Double
    Dim max_volume_ticker As String
    Dim max_volume As Double
    

    
    ' lets me know what sheet im on
    For Each ws In Worksheets
        MsgBox (ws.Name)
        
        ' initialize variables
        last_row = ws.Cells(Rows.Count, 1).End(xlUp).Row
         volume_total = 0
    
    first_open = ws.Cells(2, 3).Value
    final_close = 0
    ytd_change = 0
    yearly_change = 0
    percent_change = 0 ' he stated these werent needed, why not?
    'greatest_increase = ws.Cells(2, 15).Value
   ' greatest_increase = 0
    max_increase = 0
    min_increase = 0
    max_volume = 0
    
    
    ' details for conditional formatting  (1st attempt)
    'Dim c As Range
    'Set c = Range("K2:K50")    ' K70926")
   
     
    Dim summary_table_row As Integer
    summary_table_row = 2

        'greatest_increase = WorksheetFunction.Max(i, 11) (attempt tp find the max result)
    
       
        'greatest_increase = WorksheetFunction.Max(Range("K2:K25"))
            


  ' Loop through all stock prices
  
  
  For i = 2 To last_row
  
  
    'volume_total = volume_total + Cells(i, 7).Value

    ' Check if we are still within the same stock, if not...
        If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then

      ' Message Box the unique stock ticker (check worked)
      ' MsgBox (Cells(i, 1).Value)
      
      ' final close details??? ask how this is actually pulling the value
      final_close = ws.Cells(i, 6).Value
      
      ' how to get the first open
      ' first_open = Cells(i, 2)
      
  ' Do Work i.e. design the codes for what you actually want to happen
        If first_open = 0 Then
            percent_change = 0
            
            Else
                percent_change = 100 * (yearly_change / 0.00000001)
            End If
        
       
        'MyRange.FormatConditions.Delete (1st attempt at cond formatting)
        
        yearly_change = final_close - first_open
  
        volume_total = volume_total + ws.Cells(i, 7).Value
    
        stock_ticker = ws.Cells(i, 1).Value
        
        percent_change = 100 * (yearly_change / first_open)
        
        'close minus open/open *100
    
        ws.Cells(summary_table_row, 9).Value = stock_ticker
        ws.Cells(summary_table_row, 12).Value = volume_total
        ws.Cells(summary_table_row, 10).Value = yearly_change
        ws.Cells(summary_table_row, 11).Value = percent_change
        
        ' copied from homework class reviewn but not used
        'If yearly_change > 0 Then
        '   ws.Cells(summary_table_row, 10).Interior>ColorIndex = 4
        ' else
            ' ws.Cells(summary_table_row, 10)Interior.ColorIndex =3
        ' End if
            
        
        ' 1st attempt at conditional formatting***
        'MyRange.FormatConditions.Delete
        
        
        'MyRange.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess,
        'Formula1:="=0"
        'MyRange.FormatConditions(1).Interior.Color = RGB(255, 0, 0)
        
        'MyRange.FormatConditions(2).Add Type:=xlCellValue, Operator:=xlGreater,
        'Formula1:="=0000000001"
        'MyRange.FormatConditions(2).Interior.Color = RGB(0, 255, 0)
    
    
    
    ' reset rummary table and volume
        summary_table_row = summary_table_row + 1
        volume_total = 0
    
    ' obtain the first open of the subsequent group
        first_open = ws.Cells(i + 1, 3).Value
        

        
        
     Else

      ' Add to the volume Total
      volume_total = volume_total + ws.Cells(i, 7).Value
      
     
        
    End If
        
   Next i
   
   ' couldnt figure out how to do it for both positive and negative
   ' in the previous section as it would not recognize any value between
   ' 0 and 1.  so line 19 (0.72)had no fill at all.  this worked an i
   ' later learned an easier way in the class videos.
   
   For i = 2 To last_row

        ' attempt to remove previous code for the percent change column
       ' ws.Cells(i, 11)FormatConditions.Delete
    
        If ws.Cells(i, 10).Value > 0 Then
            ws.Cells(i, 10).Interior.ColorIndex = 4
            
            Else
                ws.Cells(i, 10).Interior.ColorIndex = 3
                
            
        End If
        
      Next i
      
      ' looping through summary table??
      For j = 2 To ws.Cells(Rows.Count, 9).End(xlUp).Row
        If (ws.Cells(j, 11).Value > max_increase) Then
            max_increase = ws.Cells(j, 11).Value
            max_increase_ticker = ws.Cells(j, 9).Value
        End If
        
        If (ws.Cells(j, 11).Value < min_increase) Then
            min_increase = ws.Cells(j, 11).Value
            min_increase_ticker = ws.Cells(j, 9).Value
        End If
        
        If (ws.Cells(j, 12).Value > max_volume) Then
            max_volume = ws.Cells(j, 12).Value
            max_volume_ticker = ws.Cells(j, 9).Value
        End If
        
            
      Next j
      
      ' write to second summary table
      Range("P2").Value = max_increase_ticker
      Range("Q2").Value = max_increase
      Range("P3").Value = min_increase_ticker
      Range("Q3").Value = min_increase
      Range("P4").Value = max_volume_ticker
      Range("Q4").Value = max_volume
      
     Exit For
     
    Next ' next woksheet
    
End Sub
